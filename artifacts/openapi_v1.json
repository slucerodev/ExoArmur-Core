{
  "components": {
    "schemas": {
      "ApprovalActionRequestV1": {
        "additionalProperties": false,
        "description": "Request model for approval actions (approve/deny)",
        "properties": {
          "operator_id": {
            "description": "ID of the operator performing the action",
            "title": "Operator Id",
            "type": "string"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Reason for denial (required for deny)",
            "title": "Reason"
          }
        },
        "required": [
          "operator_id"
        ],
        "title": "ApprovalActionRequestV1",
        "type": "object"
      },
      "ApprovalResponseV1": {
        "additionalProperties": false,
        "description": "Response model for approval actions",
        "properties": {
          "approval_id": {
            "description": "Approval request ID",
            "title": "Approval Id",
            "type": "string"
          },
          "created_at": {
            "description": "When the approval was created",
            "title": "Created At",
            "type": "string"
          },
          "status": {
            "description": "Approval status (PENDING/APPROVED/DENIED)",
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "approval_id",
          "status",
          "created_at"
        ],
        "title": "ApprovalResponseV1",
        "type": "object"
      },
      "ApprovalStatusResponseV1": {
        "additionalProperties": false,
        "description": "Response model for GET /v1/approvals/{approval_id}",
        "properties": {
          "approval_id": {
            "description": "Approval request ID",
            "title": "Approval Id",
            "type": "string"
          },
          "correlation_id": {
            "description": "Correlation ID from original request",
            "title": "Correlation Id",
            "type": "string"
          },
          "created_at": {
            "description": "When the approval was created",
            "title": "Created At",
            "type": "string"
          },
          "requested_action_class": {
            "description": "Action class requiring approval",
            "title": "Requested Action Class",
            "type": "string"
          },
          "status": {
            "description": "Approval status (PENDING/APPROVED/DENIED)",
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "approval_id",
          "status",
          "created_at",
          "requested_action_class",
          "correlation_id"
        ],
        "title": "ApprovalStatusResponseV1",
        "type": "object"
      },
      "AuditResponseV1": {
        "additionalProperties": false,
        "description": "Response model for GET /v1/audit/{correlation_id}",
        "properties": {
          "audit_records": {
            "description": "List of audit records for this correlation",
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "title": "Audit Records",
            "type": "array"
          },
          "correlation_id": {
            "description": "Correlation identifier",
            "title": "Correlation Id",
            "type": "string"
          },
          "retrieved_at": {
            "description": "When the audit records were retrieved",
            "title": "Retrieved At",
            "type": "string"
          },
          "total_count": {
            "description": "Total number of audit records found",
            "title": "Total Count",
            "type": "integer"
          }
        },
        "required": [
          "correlation_id",
          "audit_records",
          "total_count",
          "retrieved_at"
        ],
        "title": "AuditResponseV1",
        "type": "object"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "title": "Detail",
            "type": "array"
          }
        },
        "title": "HTTPValidationError",
        "type": "object"
      },
      "TelemetryEventV1": {
        "additionalProperties": false,
        "description": "Canonical input event received by a cell. Validated at ingest.",
        "properties": {
          "attributes": {
            "additionalProperties": true,
            "description": "Unstructured vendor fields. Must be JSON-serializable and bounded by max_event_bytes.",
            "title": "Attributes",
            "type": "object"
          },
          "cell_id": {
            "description": "Cell identifier",
            "example": "cell-okc-01",
            "title": "Cell Id",
            "type": "string"
          },
          "correlation_id": {
            "description": "Correlation identifier",
            "title": "Correlation Id",
            "type": "string"
          },
          "entity_refs": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "description": "Optional normalized references if available at source",
            "title": "Entity Refs"
          },
          "event_id": {
            "description": "ULID event identifier",
            "example": "01J...",
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "description": "Event type",
            "example": "process_start",
            "title": "Event Type",
            "type": "string"
          },
          "observed_at": {
            "description": "When the event occurred",
            "format": "date-time",
            "title": "Observed At",
            "type": "string"
          },
          "received_at": {
            "description": "When the event was received",
            "format": "date-time",
            "title": "Received At",
            "type": "string"
          },
          "schema_version": {
            "description": "Schema version",
            "example": "1.0.0",
            "title": "Schema Version",
            "type": "string"
          },
          "severity": {
            "description": "Severity level",
            "enum": [
              "low",
              "medium",
              "high",
              "critical"
            ],
            "title": "Severity",
            "type": "string"
          },
          "source": {
            "additionalProperties": true,
            "description": "Event source information",
            "examples": [
              {
                "host": "sensor-01",
                "kind": "edr",
                "name": "crowdstrike",
                "sensor_id": "sensor-123"
              }
            ],
            "title": "Source",
            "type": "object"
          },
          "tenant_id": {
            "description": "Tenant identifier",
            "example": "tenant_acme",
            "title": "Tenant Id",
            "type": "string"
          },
          "trace_id": {
            "description": "Trace identifier",
            "title": "Trace Id",
            "type": "string"
          }
        },
        "required": [
          "schema_version",
          "event_id",
          "tenant_id",
          "cell_id",
          "observed_at",
          "received_at",
          "source",
          "event_type",
          "severity",
          "attributes",
          "correlation_id",
          "trace_id"
        ],
        "title": "TelemetryEventV1",
        "type": "object"
      },
      "TelemetryIngestResponseV1": {
        "additionalProperties": false,
        "description": "Response model for POST /v1/telemetry/ingest",
        "properties": {
          "accepted": {
            "description": "Whether the telemetry was accepted for processing",
            "title": "Accepted",
            "type": "boolean"
          },
          "approval_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Approval ID if approval required",
            "title": "Approval Id"
          },
          "approval_status": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Approval status (PENDING/APPROVED/DENIED)",
            "title": "Approval Status"
          },
          "belief_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Generated belief ID if available",
            "title": "Belief Id"
          },
          "correlation_id": {
            "description": "Correlation identifier from request",
            "title": "Correlation Id",
            "type": "string"
          },
          "event_id": {
            "description": "Event ID from request",
            "title": "Event Id",
            "type": "string"
          },
          "processed_at": {
            "description": "When the request was processed",
            "title": "Processed At",
            "type": "string"
          },
          "safety_verdict": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Safety verdict (require_human/require_quorum)",
            "title": "Safety Verdict"
          },
          "trace_id": {
            "description": "Trace identifier from request",
            "title": "Trace Id",
            "type": "string"
          }
        },
        "required": [
          "accepted",
          "correlation_id",
          "event_id",
          "processed_at",
          "trace_id"
        ],
        "title": "TelemetryIngestResponseV1",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "title": "Location",
            "type": "array"
          },
          "msg": {
            "title": "Message",
            "type": "string"
          },
          "type": {
            "title": "Error Type",
            "type": "string"
          }
        },
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError",
        "type": "object"
      }
    }
  },
  "info": {
    "description": "Autonomous Defense Mesh Organism v1 - Thin Vertical Slice API",
    "title": "ExoArmur ADMO v1 API",
    "version": "1.0.0"
  },
  "openapi": "3.1.0",
  "paths": {
    "/": {
      "get": {
        "description": "Root endpoint",
        "operationId": "root__get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Root"
      }
    },
    "/api/v2/identity_containment/execute/{approval_id}": {
      "post": {
        "description": "Execute containment with approval",
        "operationId": "execute_approval_api_v2_identity_containment_execute__approval_id__post",
        "parameters": [
          {
            "in": "path",
            "name": "approval_id",
            "required": true,
            "schema": {
              "title": "Approval Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Execute Approval"
      }
    },
    "/api/v2/identity_containment/intents/from_recommendation": {
      "post": {
        "description": "Create intent from recommendation",
        "operationId": "create_intent_from_recommendation_api_v2_identity_containment_intents_from_recommendation_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "title": "Request",
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Intent From Recommendation"
      }
    },
    "/api/v2/identity_containment/intents/{intent_id}": {
      "get": {
        "description": "Get intent details",
        "operationId": "get_intent_api_v2_identity_containment_intents__intent_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "intent_id",
            "required": true,
            "schema": {
              "title": "Intent Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Intent"
      }
    },
    "/api/v2/identity_containment/recommendations": {
      "post": {
        "description": "Create containment recommendation",
        "operationId": "create_recommendation_api_v2_identity_containment_recommendations_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "title": "Request",
                "type": "object"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Recommendation"
      }
    },
    "/api/v2/identity_containment/status": {
      "get": {
        "description": "Get containment status for a subject",
        "operationId": "get_containment_status_api_v2_identity_containment_status_get",
        "parameters": [
          {
            "in": "query",
            "name": "subject_id",
            "required": true,
            "schema": {
              "title": "Subject Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "provider",
            "required": true,
            "schema": {
              "title": "Provider",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Containment Status"
      }
    },
    "/api/v2/identity_containment/tick": {
      "post": {
        "description": "Process expirations and revert expired containments",
        "operationId": "tick_api_v2_identity_containment_tick_post",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Tick"
      }
    },
    "/health": {
      "get": {
        "description": "Health check endpoint",
        "operationId": "health_check_health_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Check"
      }
    },
    "/v1/approvals/{approval_id}": {
      "get": {
        "description": "Get approval status",
        "operationId": "get_approval_status_v1_approvals__approval_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "approval_id",
            "required": true,
            "schema": {
              "title": "Approval Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalStatusResponseV1"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Approval Status"
      }
    },
    "/v1/approvals/{approval_id}/approve": {
      "post": {
        "description": "Approve an approval request",
        "operationId": "approve_approval_v1_approvals__approval_id__approve_post",
        "parameters": [
          {
            "in": "path",
            "name": "approval_id",
            "required": true,
            "schema": {
              "title": "Approval Id",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApprovalActionRequestV1"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponseV1"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Approve Approval"
      }
    },
    "/v1/approvals/{approval_id}/deny": {
      "post": {
        "description": "Deny an approval request",
        "operationId": "deny_approval_v1_approvals__approval_id__deny_post",
        "parameters": [
          {
            "in": "path",
            "name": "approval_id",
            "required": true,
            "schema": {
              "title": "Approval Id",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApprovalActionRequestV1"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponseV1"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Deny Approval"
      }
    },
    "/v1/audit/{correlation_id}": {
      "get": {
        "description": "Get audit records for a correlation ID",
        "operationId": "get_audit_records_v1_audit__correlation_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "correlation_id",
            "required": true,
            "schema": {
              "title": "Correlation Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseV1"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Audit Records"
      }
    },
    "/v1/telemetry/ingest": {
      "post": {
        "description": "Ingest telemetry event and process through ADMO loop",
        "operationId": "ingest_telemetry_v1_telemetry_ingest_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelemetryEventV1"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TelemetryIngestResponseV1"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ingest Telemetry"
      }
    }
  }
}